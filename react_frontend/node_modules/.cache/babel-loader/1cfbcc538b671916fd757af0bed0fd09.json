{"ast":null,"code":"import _regeneratorRuntime from\"/home/filipe/Desktop/PEI/git/PEI/react_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/filipe/Desktop/PEI/git/PEI/react_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/filipe/Desktop/PEI/git/PEI/react_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/*!\n\n=========================================================\n* Argon Dashboard React - v1.1.0\n=========================================================\n\n* Product Page: https://www.creative-tim.com/product/argon-dashboard-react\n* Copyright 2019 Creative Tim (https://www.creative-tim.com)\n* Licensed under MIT (https://github.com/creativetimofficial/argon-dashboard-react/blob/master/LICENSE.md)\n\n* Coded by Creative Tim\n\n=========================================================\n\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\n*/import React,{useState,useEffect}from\"react\";// react plugin used to create google maps\n// reactstrap components\nimport{Card,Container,Row}from\"reactstrap\";// core components\nimport Header from\"../../components/Headers/Header.js\";import Maps from\"./Maps_Component.js\";const call_time=2000;const Maps_Page=()=>{const _useState=useState({lat:0,lng:0}),_useState2=_slicedToArray(_useState,2),myposition=_useState2[0],setMyposition=_useState2[1];const _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),markers=_useState4[0],setMarkers=_useState4[1];useEffect(()=>{get_my_location().then(value=>{setMyposition({lat:value.coords.latitude,lng:value.coords.longitude});});},[]);useEffect(()=>{const interval=setInterval(()=>{getAllLocations().then(value=>{setMarkers(value);});},call_time);return()=>clearInterval(interval);},[]);const get_my_location=function get_my_location(){if(navigator.geolocation){return new Promise((resolve,reject)=>navigator.geolocation.getCurrentPosition(resolve,reject));}else{return new Promise(resolve=>resolve({}));}};const getAllLocations=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,result,all_locations,i;return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"/list_accidents\");case 2:response=_context.sent;_context.next=5;return response.json();case 5:result=_context.sent;all_locations=[];for(i=0;i<result.length;i++){all_locations.push({lat:result[i][\"location\"][\"lat\"],lng:result[i][\"location\"][\"lng\"],id:result[i][\"id\"]});}return _context.abrupt(\"return\",all_locations);case 9:case\"end\":return _context.stop();}},_callee);}));return function getAllLocations(){return _ref.apply(this,arguments);};}();// componentDidMount() {\n//   Promise.all([this.get_my_location(),this.getAllLocations()]).then((\n//     (values => \n//       {\n//         this.setState(prevState => (\n//           {\n//             markers: values[1],\n//             initial_position:{\n//               lat: values[0].coords.latitude,\n//               lng: values[0].coords.longitude\n//             }\n//           }))\n//       }\n//     )))\n// }\nreturn/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(Container,{className:\"mt--7\",fluid:true},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},/*#__PURE__*/React.createElement(Card,{className:\"shadow border-0\"},/*#__PURE__*/React.createElement(Maps,{markers:markers,Location:myposition,googleMapURL:\"https://maps.googleapis.com/maps/api/js?key=AIzaSyD4aWR3SBGaa1oB0CuDf2vptnJfSMSguZU\",loadingElement:/*#__PURE__*/React.createElement(\"div\",{style:{height:\"100%\"}}),center:myposition,zoom:10,containerElement:/*#__PURE__*/React.createElement(\"div\",{style:{height:\"600px\"},className:\"map-canvas\",id:\"map-canvas\"}),mapElement:/*#__PURE__*/React.createElement(\"div\",{style:{height:\"100%\",borderRadius:\"inherit\"}})}))))));};export default Maps_Page;","map":{"version":3,"sources":["/home/filipe/Desktop/PEI/git/PEI/react_frontend/src/views/examples/Maps_Page.js"],"names":["React","useState","useEffect","Card","Container","Row","Header","Maps","call_time","Maps_Page","lat","lng","myposition","setMyposition","markers","setMarkers","get_my_location","then","value","coords","latitude","longitude","interval","setInterval","getAllLocations","clearInterval","navigator","geolocation","Promise","resolve","reject","getCurrentPosition","fetch","response","json","result","all_locations","i","length","push","id","height","borderRadius"],"mappings":"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","sourcesContent":["/*!\n\n=========================================================\n* Argon Dashboard React - v1.1.0\n=========================================================\n\n* Product Page: https://www.creative-tim.com/product/argon-dashboard-react\n* Copyright 2019 Creative Tim (https://www.creative-tim.com)\n* Licensed under MIT (https://github.com/creativetimofficial/argon-dashboard-react/blob/master/LICENSE.md)\n\n* Coded by Creative Tim\n\n=========================================================\n\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\n*/\nimport React, {useState,useEffect} from \"react\";\n// react plugin used to create google maps\n// reactstrap components\nimport {Card, Container, Row} from \"reactstrap\";\n// core components\nimport Header from \"../../components/Headers/Header.js\";\nimport Maps from \"./Maps_Component.js\";\n\nconst call_time = 2000;\n\n\nconst Maps_Page = () => {\n\n  const [myposition, setMyposition] = useState(\n    {\n    lat: 0,\n    lng: 0\n    });\n  \n  const [markers, setMarkers] = useState([]);\n\n  useEffect(() => {\n    get_my_location().then((value) => {\n     setMyposition(\n        {\n          lat: value.coords.latitude,\n          lng: value.coords.longitude\n        })}\n    )},[]);\n\n  useEffect(() => {\n\n    const interval = setInterval(\n      () => {\n        getAllLocations().then((value) => {\n          setMarkers(value)}\n        )\n      }, call_time);\n\n      return () => clearInterval(interval)\n    },[]\n  )\n\n  const  get_my_location = function () {\n    if (navigator.geolocation) {\n      return new Promise(\n        (resolve, reject) => navigator.geolocation.getCurrentPosition(resolve, reject)\n      )\n    } else {\n      return new Promise(\n        resolve => resolve({})\n      )\n    }\n  }\n\n  const getAllLocations = async () => {\n    let response = await fetch(\n      `/list_accidents`);\n    let result = await response.json();\n    let all_locations = [];\n    for (let i=0; i < result.length; i++){\n      all_locations.push(\n        {\n          lat: result[i][\"location\"][\"lat\"],\n          lng: result[i][\"location\"][\"lng\"],\n          id: result[i][\"id\"]\n        }\n      )\n    }\n    return all_locations;\n  }\n\n  // componentDidMount() {\n\n  //   Promise.all([this.get_my_location(),this.getAllLocations()]).then((\n  //     (values => \n  //       {\n  //         this.setState(prevState => (\n  //           {\n  //             markers: values[1],\n  //             initial_position:{\n  //               lat: values[0].coords.latitude,\n  //               lng: values[0].coords.longitude\n  //             }\n  //           }))\n  //       }\n  //     )))\n  // }\n\n\n  return(\n      <>\n        <Header />\n        {/* Page content */}\n        <Container className=\"mt--7\" fluid>\n          <Row>\n            <div className=\"col\">\n              <Card className=\"shadow border-0\">\n                <Maps\n                  markers={markers}\n                  Location={myposition}\n                  googleMapURL=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyD4aWR3SBGaa1oB0CuDf2vptnJfSMSguZU\"\n                  loadingElement={<div style={{ height: `100%` }} />}\n                  center = {myposition}\n                  zoom = {10}\n                  containerElement={\n                    <div\n                      style={{ height: `600px` }}\n                      className=\"map-canvas\"\n                      id=\"map-canvas\"\n                    />\n                  }\n                  mapElement={\n                    <div style={{ height: `100%`, borderRadius: \"inherit\" }} />\n                  }\n                />\n              </Card>\n            </div>\n          </Row>\n        </Container>\n      </>\n    );\n  }\n\nexport default Maps_Page;\n"]},"metadata":{},"sourceType":"module"}